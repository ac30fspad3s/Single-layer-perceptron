import math
import random
import numpy as np

def create_Y(W, ltr):
    W = np.transpose(W)
    S = np.dot(ltr, W)
    W = np.transpose(W)
    Y = np.array(np.ones((len(S)))) 
    for j in range((len(S))): 
        if S[j] < 0:
            Y[j]=0
    return Y

def letter(W, ltr):
    Y = create_Y(W, ltr)
    for i in range(len(Y)):
        if Y[i] == 1:
            return i+1
    return 0
        
  
def fit(W, alphabet) :
    while True:
        for i in range(len(alphabet)):
            Y = create_Y(W, alphabet[i])
            d = np.array(np.zeros((len(Y)))) 
            d[i] = 1
            if not(np.array_equal(d, Y)):
                E = np.array(d - Y)
                delta_W = np.array(np.zeros((len(E), len(alphabet[0])))) # np.zeros(len(E), len(alphabet[0]))
                for j in range (len(E)):
                    for l in range (len(alphabet[0])):
                        delta_W[j][l] = E[j]*alphabet[i][l]
                W=W+delta_W
                break
            elif i == len(alphabet)-1:
                return W
       
def main():
    

    v1 = [0,1,1,1,0,1,0,0,0,1,1,0,0,0,1,1,1,1,1,1,1,0,0,0,1] #А
    v2 = [1,1,1,1,0,1,0,0,0,0,1,1,1,1,0,1,0,0,0,1,1,1,1,1,0] #Б
    v3 = [1,1,1,1,0,1,0,0,0,1,1,1,1,1,0,1,0,0,0,1,1,1,1,1,0] #В
    v4 = [1,1,1,1,1,1,0,0,0,1,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0] #Г
    v5 = [0,0,1,1,0,0,1,0,1,0,0,1,0,1,0,1,1,1,1,1,1,0,0,0,1] #Д
    v6 = [1,1,1,1,1,1,0,0,0,0,1,1,1,1,0,1,0,0,0,0,1,1,1,1,1] #Е
    v7 = [0,1,1,1,1,1,0,0,0,0,1,1,1,1,0,1,0,0,0,0,0,1,1,1,1] #Е
    v8 = [1,0,1,0,1, 1,0,1,0,1, 0,1,1,1,0, 1,0,1,0,1, 1,0,1,0,1] #Ж
    v9 = [0,0,1,1,0, 0,1,0,0,1, 0,0,0,1,0, 0,1,0,0,1, 0,0,1,1,0] #З  
    v10 = [1,0,0,0,1, 1,0,0,1,1, 1,0,1,0,1, 1,1,0,0,1, 1,0,0,0,1] #И
    v11 = [0,1,1,1,0, 0,0,0,0,0, 1,0,0,0,1, 1,0,0,1,1, 0,1,1,0,1] #Й
    v12 = [1,0,0,1,0, 1,0,1,0,0, 1,1,1,0,0, 1,0,0,1,0, 1,0,0,1,0] #К
    v13 = [0,0,0,1,1, 0,0,1,0,1, 0,0,1,0,1, 0,0,1,0,1, 0,1,0,0,1] #Л
    v14 = [1,0,0,0,1, 1,1,0,1,1, 1,0,1,0,1, 1,0,0,0,1, 1,0,0,0,1] #М
    v15 = [1,0,0,0,1, 1,0,0,0,1, 1,1,1,1,1, 1,0,0,0,1, 1,0,0,0,1] #Н
    v16 = [0,1,1,1,0, 1,0,0,0,1, 1,0,0,0,1, 1,0,0,0,1, 0,1,1,1,0] #О
    v17 = [1,1,1,1,1, 1,0,0,0,1, 1,0,0,0,1, 1,0,0,0,1, 1,0,0,0,1] #П
    v18 = [1,1,1,1,0, 1,0,0,0,1, 1,0,0,0,1, 1,1,1,1,0, 1,0,0,0,0] #Р
    v19 = [0,1,1,0,0, 1,0,0,1,0, 1,0,0,0,0, 1,0,0,1,0, 0,1,1,0,0] #С
    v20 = [1,1,1,1,1, 0,0,1,0,0, 0,0,1,0,0, 0,0,1,0,0, 0,0,1,0,0] #Т
    v21 = [0,1,0,0,1, 0,1,0,0,1, 0,0,1,1,0, 0,0,0,1,0, 0,1,1,0,0] #У
    v22 = [0,1,1,1,0, 1,0,1,0,1, 1,0,1,0,1, 0,1,1,1,0, 0,0,1,0,0] #Ф
    v23 = [1,0,0,0,1, 0,1,0,1,0, 0,0,1,0,0, 0,1,0,1,0, 1,0,0,0,1] #X
    v24 = [1,0,0,1,0, 1,0,0,1,0, 1,0,0,1,0, 1,1,1,1,1, 0,0,0,0,1] #Ц
    v25 = [0,1,0,0,1, 0,1,0,0,1, 0,1,0,0,1, 0,0,1,1,1, 0,0,0,0,1] #Ч
    v26 = [1,0,1,0,1, 1,0,1,0,1, 1,0,1,0,1, 1,0,1,0,1, 1,1,1,1,1] #Ш
    v27 = [1,0,1,0,1, 1,0,1,0,1, 1,0,1,0,1, 1,1,1,1,1, 0,0,0,0,1] #Щ
    v28 = [1,1,0,0,0, 0,1,1,1,0, 0,1,0,0,1, 0,1,0,0,1, 0,1,1,1,0] #Ъ
    v29 = [1,0,0,0,1, 1,0,0,0,0, 1,1,0,0,1, 1,0,1,0,1, 1,1,0,0,1] #Ы
    v30 = [1,0,0,0,0, 1,1,1,0,0, 1,0,0,1,0, 1,0,0,1,0, 1,1,1,0,0] #Ь
    v31 = [1,1,1,1,0, 0,0,0,0,1, 0,1,1,1,1, 0,0,0,0,1, 1,1,1,1,0] #Э
    v32 = [1,0,0,1,0, 1,0,1,0,1, 1,1,1,0,1, 1,0,1,0,1, 1,0,0,1,0] #Ю
    v33 = [0,1,1,1,1, 1,0,0,0,1, 1,0,0,0,0, 0,1,1,1,1, 1,0,0,0,1] #Я

    alphabet = np.array([v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,v11,
                         v12,v13,v14,v15,v16,v17,v18,v19,v20,
                         v21,v22,v23,v24,v25,v26,v27,v28,v29,v30,v31,v32,v33])
    
    W = np.array(np.random.randint(2, size=(len(alphabet), len(v1))))

    for i in range(len(alphabet)):
        print(letter(W, alphabet[i]))
        
    W = fit(W, alphabet)
    print()

    for i in range(len(alphabet)):
        print(letter(W, alphabet[i]))

    print()

    print(letter(W, alphabet[20]))    
 
main()
   
